{"version":3,"file":"react-dxf-viewer.es.js","sources":["../node_modules/.pnpm/react@19.2.3/node_modules/react/cjs/react-jsx-runtime.production.js","../node_modules/.pnpm/react@19.2.3/node_modules/react/cjs/react-jsx-runtime.development.js","../node_modules/.pnpm/react@19.2.3/node_modules/react/jsx-runtime.js","../src/utils/threeUtils.ts","../src/utils/EntityInteraction.ts","../src/utils/PolygonSelectionTool.ts","../node_modules/.pnpm/lucide-react@0.469.0_react@19.2.3/node_modules/lucide-react/dist/esm/shared/src/utils.js","../node_modules/.pnpm/lucide-react@0.469.0_react@19.2.3/node_modules/lucide-react/dist/esm/defaultAttributes.js","../node_modules/.pnpm/lucide-react@0.469.0_react@19.2.3/node_modules/lucide-react/dist/esm/Icon.js","../node_modules/.pnpm/lucide-react@0.469.0_react@19.2.3/node_modules/lucide-react/dist/esm/createLucideIcon.js","../node_modules/.pnpm/lucide-react@0.469.0_react@19.2.3/node_modules/lucide-react/dist/esm/icons/rotate-ccw.js","../node_modules/.pnpm/lucide-react@0.469.0_react@19.2.3/node_modules/lucide-react/dist/esm/icons/square-dashed-mouse-pointer.js","../node_modules/.pnpm/lucide-react@0.469.0_react@19.2.3/node_modules/lucide-react/dist/esm/icons/zoom-in.js","../node_modules/.pnpm/lucide-react@0.469.0_react@19.2.3/node_modules/lucide-react/dist/esm/icons/zoom-out.js","../src/components/dxfViewer.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar REACT_ELEMENT_TYPE = Symbol.for(\"react.transitional.element\"),\n  REACT_FRAGMENT_TYPE = Symbol.for(\"react.fragment\");\nfunction jsxProd(type, config, maybeKey) {\n  var key = null;\n  void 0 !== maybeKey && (key = \"\" + maybeKey);\n  void 0 !== config.key && (key = \"\" + config.key);\n  if (\"key\" in config) {\n    maybeKey = {};\n    for (var propName in config)\n      \"key\" !== propName && (maybeKey[propName] = config[propName]);\n  } else maybeKey = config;\n  config = maybeKey.ref;\n  return {\n    $$typeof: REACT_ELEMENT_TYPE,\n    type: type,\n    key: key,\n    ref: void 0 !== config ? config : null,\n    props: maybeKey\n  };\n}\nexports.Fragment = REACT_FRAGMENT_TYPE;\nexports.jsx = jsxProd;\nexports.jsxs = jsxProd;\n","/**\n * @license React\n * react-jsx-runtime.development.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\"production\" !== process.env.NODE_ENV &&\n  (function () {\n    function getComponentNameFromType(type) {\n      if (null == type) return null;\n      if (\"function\" === typeof type)\n        return type.$$typeof === REACT_CLIENT_REFERENCE\n          ? null\n          : type.displayName || type.name || null;\n      if (\"string\" === typeof type) return type;\n      switch (type) {\n        case REACT_FRAGMENT_TYPE:\n          return \"Fragment\";\n        case REACT_PROFILER_TYPE:\n          return \"Profiler\";\n        case REACT_STRICT_MODE_TYPE:\n          return \"StrictMode\";\n        case REACT_SUSPENSE_TYPE:\n          return \"Suspense\";\n        case REACT_SUSPENSE_LIST_TYPE:\n          return \"SuspenseList\";\n        case REACT_ACTIVITY_TYPE:\n          return \"Activity\";\n      }\n      if (\"object\" === typeof type)\n        switch (\n          (\"number\" === typeof type.tag &&\n            console.error(\n              \"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"\n            ),\n          type.$$typeof)\n        ) {\n          case REACT_PORTAL_TYPE:\n            return \"Portal\";\n          case REACT_CONTEXT_TYPE:\n            return type.displayName || \"Context\";\n          case REACT_CONSUMER_TYPE:\n            return (type._context.displayName || \"Context\") + \".Consumer\";\n          case REACT_FORWARD_REF_TYPE:\n            var innerType = type.render;\n            type = type.displayName;\n            type ||\n              ((type = innerType.displayName || innerType.name || \"\"),\n              (type = \"\" !== type ? \"ForwardRef(\" + type + \")\" : \"ForwardRef\"));\n            return type;\n          case REACT_MEMO_TYPE:\n            return (\n              (innerType = type.displayName || null),\n              null !== innerType\n                ? innerType\n                : getComponentNameFromType(type.type) || \"Memo\"\n            );\n          case REACT_LAZY_TYPE:\n            innerType = type._payload;\n            type = type._init;\n            try {\n              return getComponentNameFromType(type(innerType));\n            } catch (x) {}\n        }\n      return null;\n    }\n    function testStringCoercion(value) {\n      return \"\" + value;\n    }\n    function checkKeyStringCoercion(value) {\n      try {\n        testStringCoercion(value);\n        var JSCompiler_inline_result = !1;\n      } catch (e) {\n        JSCompiler_inline_result = !0;\n      }\n      if (JSCompiler_inline_result) {\n        JSCompiler_inline_result = console;\n        var JSCompiler_temp_const = JSCompiler_inline_result.error;\n        var JSCompiler_inline_result$jscomp$0 =\n          (\"function\" === typeof Symbol &&\n            Symbol.toStringTag &&\n            value[Symbol.toStringTag]) ||\n          value.constructor.name ||\n          \"Object\";\n        JSCompiler_temp_const.call(\n          JSCompiler_inline_result,\n          \"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.\",\n          JSCompiler_inline_result$jscomp$0\n        );\n        return testStringCoercion(value);\n      }\n    }\n    function getTaskName(type) {\n      if (type === REACT_FRAGMENT_TYPE) return \"<>\";\n      if (\n        \"object\" === typeof type &&\n        null !== type &&\n        type.$$typeof === REACT_LAZY_TYPE\n      )\n        return \"<...>\";\n      try {\n        var name = getComponentNameFromType(type);\n        return name ? \"<\" + name + \">\" : \"<...>\";\n      } catch (x) {\n        return \"<...>\";\n      }\n    }\n    function getOwner() {\n      var dispatcher = ReactSharedInternals.A;\n      return null === dispatcher ? null : dispatcher.getOwner();\n    }\n    function UnknownOwner() {\n      return Error(\"react-stack-top-frame\");\n    }\n    function hasValidKey(config) {\n      if (hasOwnProperty.call(config, \"key\")) {\n        var getter = Object.getOwnPropertyDescriptor(config, \"key\").get;\n        if (getter && getter.isReactWarning) return !1;\n      }\n      return void 0 !== config.key;\n    }\n    function defineKeyPropWarningGetter(props, displayName) {\n      function warnAboutAccessingKey() {\n        specialPropKeyWarningShown ||\n          ((specialPropKeyWarningShown = !0),\n          console.error(\n            \"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)\",\n            displayName\n          ));\n      }\n      warnAboutAccessingKey.isReactWarning = !0;\n      Object.defineProperty(props, \"key\", {\n        get: warnAboutAccessingKey,\n        configurable: !0\n      });\n    }\n    function elementRefGetterWithDeprecationWarning() {\n      var componentName = getComponentNameFromType(this.type);\n      didWarnAboutElementRef[componentName] ||\n        ((didWarnAboutElementRef[componentName] = !0),\n        console.error(\n          \"Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.\"\n        ));\n      componentName = this.props.ref;\n      return void 0 !== componentName ? componentName : null;\n    }\n    function ReactElement(type, key, props, owner, debugStack, debugTask) {\n      var refProp = props.ref;\n      type = {\n        $$typeof: REACT_ELEMENT_TYPE,\n        type: type,\n        key: key,\n        props: props,\n        _owner: owner\n      };\n      null !== (void 0 !== refProp ? refProp : null)\n        ? Object.defineProperty(type, \"ref\", {\n            enumerable: !1,\n            get: elementRefGetterWithDeprecationWarning\n          })\n        : Object.defineProperty(type, \"ref\", { enumerable: !1, value: null });\n      type._store = {};\n      Object.defineProperty(type._store, \"validated\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: 0\n      });\n      Object.defineProperty(type, \"_debugInfo\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: null\n      });\n      Object.defineProperty(type, \"_debugStack\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: debugStack\n      });\n      Object.defineProperty(type, \"_debugTask\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: debugTask\n      });\n      Object.freeze && (Object.freeze(type.props), Object.freeze(type));\n      return type;\n    }\n    function jsxDEVImpl(\n      type,\n      config,\n      maybeKey,\n      isStaticChildren,\n      debugStack,\n      debugTask\n    ) {\n      var children = config.children;\n      if (void 0 !== children)\n        if (isStaticChildren)\n          if (isArrayImpl(children)) {\n            for (\n              isStaticChildren = 0;\n              isStaticChildren < children.length;\n              isStaticChildren++\n            )\n              validateChildKeys(children[isStaticChildren]);\n            Object.freeze && Object.freeze(children);\n          } else\n            console.error(\n              \"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\"\n            );\n        else validateChildKeys(children);\n      if (hasOwnProperty.call(config, \"key\")) {\n        children = getComponentNameFromType(type);\n        var keys = Object.keys(config).filter(function (k) {\n          return \"key\" !== k;\n        });\n        isStaticChildren =\n          0 < keys.length\n            ? \"{key: someKey, \" + keys.join(\": ..., \") + \": ...}\"\n            : \"{key: someKey}\";\n        didWarnAboutKeySpread[children + isStaticChildren] ||\n          ((keys =\n            0 < keys.length ? \"{\" + keys.join(\": ..., \") + \": ...}\" : \"{}\"),\n          console.error(\n            'A props object containing a \"key\" prop is being spread into JSX:\\n  let props = %s;\\n  <%s {...props} />\\nReact keys must be passed directly to JSX without using spread:\\n  let props = %s;\\n  <%s key={someKey} {...props} />',\n            isStaticChildren,\n            children,\n            keys,\n            children\n          ),\n          (didWarnAboutKeySpread[children + isStaticChildren] = !0));\n      }\n      children = null;\n      void 0 !== maybeKey &&\n        (checkKeyStringCoercion(maybeKey), (children = \"\" + maybeKey));\n      hasValidKey(config) &&\n        (checkKeyStringCoercion(config.key), (children = \"\" + config.key));\n      if (\"key\" in config) {\n        maybeKey = {};\n        for (var propName in config)\n          \"key\" !== propName && (maybeKey[propName] = config[propName]);\n      } else maybeKey = config;\n      children &&\n        defineKeyPropWarningGetter(\n          maybeKey,\n          \"function\" === typeof type\n            ? type.displayName || type.name || \"Unknown\"\n            : type\n        );\n      return ReactElement(\n        type,\n        children,\n        maybeKey,\n        getOwner(),\n        debugStack,\n        debugTask\n      );\n    }\n    function validateChildKeys(node) {\n      isValidElement(node)\n        ? node._store && (node._store.validated = 1)\n        : \"object\" === typeof node &&\n          null !== node &&\n          node.$$typeof === REACT_LAZY_TYPE &&\n          (\"fulfilled\" === node._payload.status\n            ? isValidElement(node._payload.value) &&\n              node._payload.value._store &&\n              (node._payload.value._store.validated = 1)\n            : node._store && (node._store.validated = 1));\n    }\n    function isValidElement(object) {\n      return (\n        \"object\" === typeof object &&\n        null !== object &&\n        object.$$typeof === REACT_ELEMENT_TYPE\n      );\n    }\n    var React = require(\"react\"),\n      REACT_ELEMENT_TYPE = Symbol.for(\"react.transitional.element\"),\n      REACT_PORTAL_TYPE = Symbol.for(\"react.portal\"),\n      REACT_FRAGMENT_TYPE = Symbol.for(\"react.fragment\"),\n      REACT_STRICT_MODE_TYPE = Symbol.for(\"react.strict_mode\"),\n      REACT_PROFILER_TYPE = Symbol.for(\"react.profiler\"),\n      REACT_CONSUMER_TYPE = Symbol.for(\"react.consumer\"),\n      REACT_CONTEXT_TYPE = Symbol.for(\"react.context\"),\n      REACT_FORWARD_REF_TYPE = Symbol.for(\"react.forward_ref\"),\n      REACT_SUSPENSE_TYPE = Symbol.for(\"react.suspense\"),\n      REACT_SUSPENSE_LIST_TYPE = Symbol.for(\"react.suspense_list\"),\n      REACT_MEMO_TYPE = Symbol.for(\"react.memo\"),\n      REACT_LAZY_TYPE = Symbol.for(\"react.lazy\"),\n      REACT_ACTIVITY_TYPE = Symbol.for(\"react.activity\"),\n      REACT_CLIENT_REFERENCE = Symbol.for(\"react.client.reference\"),\n      ReactSharedInternals =\n        React.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,\n      hasOwnProperty = Object.prototype.hasOwnProperty,\n      isArrayImpl = Array.isArray,\n      createTask = console.createTask\n        ? console.createTask\n        : function () {\n            return null;\n          };\n    React = {\n      react_stack_bottom_frame: function (callStackForError) {\n        return callStackForError();\n      }\n    };\n    var specialPropKeyWarningShown;\n    var didWarnAboutElementRef = {};\n    var unknownOwnerDebugStack = React.react_stack_bottom_frame.bind(\n      React,\n      UnknownOwner\n    )();\n    var unknownOwnerDebugTask = createTask(getTaskName(UnknownOwner));\n    var didWarnAboutKeySpread = {};\n    exports.Fragment = REACT_FRAGMENT_TYPE;\n    exports.jsx = function (type, config, maybeKey) {\n      var trackActualOwner =\n        1e4 > ReactSharedInternals.recentlyCreatedOwnerStacks++;\n      return jsxDEVImpl(\n        type,\n        config,\n        maybeKey,\n        !1,\n        trackActualOwner\n          ? Error(\"react-stack-top-frame\")\n          : unknownOwnerDebugStack,\n        trackActualOwner ? createTask(getTaskName(type)) : unknownOwnerDebugTask\n      );\n    };\n    exports.jsxs = function (type, config, maybeKey) {\n      var trackActualOwner =\n        1e4 > ReactSharedInternals.recentlyCreatedOwnerStacks++;\n      return jsxDEVImpl(\n        type,\n        config,\n        maybeKey,\n        !0,\n        trackActualOwner\n          ? Error(\"react-stack-top-frame\")\n          : unknownOwnerDebugStack,\n        trackActualOwner ? createTask(getTaskName(type)) : unknownOwnerDebugTask\n      );\n    };\n  })();\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","import * as THREE from 'three';\n\n/**\n * Safely computes the bounding box for a Three.js object, skipping invalid coordinates.\n */\nexport function getSafeObjectBounds(obj: THREE.Object3D): THREE.Box3 | null {\n  const isLine2 = (obj as any).isLineSegments2;\n\n  if (!(obj instanceof THREE.Mesh || obj instanceof THREE.Line || obj instanceof THREE.LineSegments || isLine2)) {\n    return null;\n  }\n  \n\n  const geometry = (obj as THREE.Mesh).geometry;\n  if (!geometry) return null;\n\n  if (isLine2) {\n    const startAttr = geometry.getAttribute('instanceStart');\n    const endAttr = geometry.getAttribute('instanceEnd');\n    \n    if (!startAttr || !endAttr) {\n      if (!geometry.getAttribute('position')) return null;\n    } else {\n      const box = new THREE.Box3();\n      let hasValidPoint = false;\n      obj.updateMatrixWorld(true);\n\n      const checkAttribute = (attr: THREE.BufferAttribute | THREE.InterleavedBufferAttribute) => {\n        const array = attr.array;\n        const itemSize = attr.itemSize;\n        for (let i = 0; i < array.length; i += itemSize) {\n          const x = array[i];\n          const y = array[i + 1];\n          const z = itemSize > 2 ? array[i + 2] : 0;\n          \n          if (isFinite(x) && isFinite(y) && isFinite(z)) {\n            const point = new THREE.Vector3(x, y, z).applyMatrix4(obj.matrixWorld);\n            if (isFinite(point.x) && isFinite(point.y) && isFinite(point.z)) {\n              box.expandByPoint(point);\n              hasValidPoint = true;\n            }\n          }\n        }\n      };\n\n      checkAttribute(startAttr);\n      checkAttribute(endAttr);\n\n      return hasValidPoint ? box : null;\n    }\n  }\n\n  const positionAttribute = geometry.getAttribute('position');\n  if (!positionAttribute || !positionAttribute.array) return null;\n\n  const array = positionAttribute.array;\n  const itemSize = positionAttribute.itemSize;\n  \n  const box = new THREE.Box3();\n  let hasValidPoint = false;\n\n  obj.updateMatrixWorld(true);\n\n  for (let i = 0; i < array.length; i += itemSize) {\n    const x = array[i];\n    const y = array[i + 1];\n    const z = itemSize > 2 ? array[i + 2] : 0;\n    \n    if (isFinite(x) && isFinite(y) && isFinite(z)) {\n      const point = new THREE.Vector3(x, y, z).applyMatrix4(obj.matrixWorld);\n      if (isFinite(point.x) && isFinite(point.y) && isFinite(point.z)) {\n        box.expandByPoint(point);\n        hasValidPoint = true;\n      }\n    }\n  }\n\n  return hasValidPoint ? box : null;\n}\n\n/**\n * Safely computes the bounding box for multiple Three.js objects.\n */\nexport function getSafeObjectsBounds(objects: THREE.Object3D[]): THREE.Box3 | null {\n  const combinedBox = new THREE.Box3();\n  let hasValidBounds = false;\n\n  for (const obj of objects) {\n    const box = getSafeObjectBounds(obj);\n    if (box && !box.isEmpty()) {\n      combinedBox.union(box);\n      hasValidBounds = true;\n    }\n  }\n\n  return hasValidBounds ? combinedBox : null;\n}\n\n/**\n * Converts screen coordinates to Normalized Device Coordinates (NDC).\n */\nexport function getNDC(clientX: number, clientY: number, canvas: HTMLCanvasElement): THREE.Vector2 {\n  const rect = canvas.getBoundingClientRect();\n  return new THREE.Vector2(\n    ((clientX - rect.left) / rect.width) * 2 - 1,\n    -((clientY - rect.top) / rect.height) * 2 + 1\n  );\n}\n\n/**\n * Unprojects screen coordinates to a world position on the Z=0 plane.\n */\nexport function unprojectToPlane(clientX: number, clientY: number, canvas: HTMLCanvasElement, camera: THREE.Camera): THREE.Vector3 {\n  const ndc = getNDC(clientX, clientY, canvas);\n  const vector = new THREE.Vector3(ndc.x, ndc.y, 0);\n  vector.unproject(camera);\n  vector.z = 0;\n  return vector;\n}\n\n","import * as THREE from 'three';\nimport { getSafeObjectsBounds, getNDC } from './threeUtils';\n\n// Type import only - runtime import is dynamic\ntype DxfViewer = import('@/core/dxf-viewer-library').DxfViewer;\n\n// These are imported at runtime from JS files - declare their types inline\ndeclare function getLineMaterial(color: number, linewidth: number, opacity?: number): THREE.Material;\ndeclare function createOverlayFromCoordinates(\n  vertices: Array<{x: number, y: number, z: number}>,\n  material: THREE.Material,\n  isClosed: boolean,\n  matrixWorld: THREE.Matrix4\n): THREE.Object3D | null;\ndeclare function createOverlay(line: THREE.LineSegments, material: THREE.Material): THREE.Object3D | null;\ndeclare function updateResolution(width: number, height: number): void;\ndeclare function clearLineMaterialCache(): void;\n\n// Dynamic import wrapper for Line2Helper functions\nlet line2HelperModule: any = null;\nasync function getLine2Helper() {\n  if (!line2HelperModule) {\n    line2HelperModule = await import('@/core/dxf-viewer-library/Line2Helper.js');\n  }\n  return line2HelperModule;\n}\n\n// Synchronous versions that use cached module (assumes already loaded)\nfunction getLineMaterialSync(color: number, linewidth: number, opacity: number = 1.0): THREE.Material {\n  if (!line2HelperModule) {\n    // Fallback to basic material if not yet loaded\n    return new THREE.LineBasicMaterial({ color, linewidth, transparent: true, opacity });\n  }\n  return line2HelperModule.getLineMaterial(color, linewidth, opacity);\n}\n\nfunction createOverlayFromCoordinatesSync(\n  vertices: Array<{x: number, y: number, z: number}>,\n  material: THREE.Material,\n  isClosed: boolean,\n  matrixWorld: THREE.Matrix4\n): THREE.Object3D | null {\n  if (!line2HelperModule) return null;\n  return line2HelperModule.createOverlayFromCoordinates(vertices, material, isClosed, matrixWorld);\n}\n\nfunction createOverlaySync(line: THREE.LineSegments, material: THREE.Material): THREE.Object3D | null {\n  if (!line2HelperModule) return null;\n  return line2HelperModule.createOverlay(line, material);\n}\n\nfunction updateResolutionSync(width: number, height: number): void {\n  if (line2HelperModule) {\n    line2HelperModule.updateResolution(width, height);\n  }\n}\n\nfunction clearLineMaterialCacheSync(): void {\n  if (line2HelperModule) {\n    line2HelperModule.clearLineMaterialCache();\n  }\n}\n\n/**\n * Generic Entity Interaction Handler\n * \n * Handles click/hover interactions with DXF entities.\n * This is a decoupled version that works with any DXF entities, not just rebars.\n */\nexport class EntityInteraction {\n    private viewer: DxfViewer;\n    private hoveredObject: THREE.Object3D | null = null;\n    private isMouseDown: boolean = false;\n    private isDragging: boolean = false;\n    \n    private interactionLayer: THREE.Group;\n    private activeOverlays: Map<THREE.Object3D, THREE.Object3D> = new Map();\n    private selectedHandles: Set<string> = new Set();\n    private validHandles: Set<string> = new Set(); \n    \n    private intersectableObjectsCache: THREE.Object3D[] | null = null;\n    private cacheLastUpdated: number = 0;\n    private readonly CACHE_TTL = 2000;\n    \n    private dxfEntities: Map<string, any> | null = null;\n\n    private _boundOnPointerMove: (e: PointerEvent) => void;\n    private _boundOnPointerLeave: (e: PointerEvent) => void;\n    private _boundOnPointerDown: (e: PointerEvent) => void;\n    private _boundOnPointerUp: (e: PointerEvent) => void;\n    private _boundOnViewChanged: () => void;\n\n    private isEnabled: boolean = true;\n    private onClick?: (handle: string) => void;\n\n    private boundingBoxMesh: THREE.Mesh | null = null;\n    private animationFrameId: number | null = null;\n\n    private _boundOnLoaded: () => void;\n    private _boundOnCleared: () => void;\n\n    constructor(viewer: DxfViewer, onClick?: (handle: string) => void) {\n        this.viewer = viewer;\n        this.onClick = onClick;\n\n        this.interactionLayer = new THREE.Group();\n        this.interactionLayer.name = \"InteractionLayer\";\n        this.interactionLayer.renderOrder = 999;\n        this.viewer.GetScene().add(this.interactionLayer);\n\n        this.updateResolution();\n\n        this._boundOnPointerMove = this._onPointerMove.bind(this);\n        this._boundOnPointerLeave = this._onPointerLeave.bind(this);\n        this._boundOnPointerDown = this._onPointerDown.bind(this);\n        this._boundOnPointerUp = this._onPointerUp.bind(this);\n        this._boundOnViewChanged = this.updateResolution.bind(this);\n        this._boundOnLoaded = this._onLoaded.bind(this);\n        this._boundOnCleared = this._onCleared.bind(this);\n\n        this.setupEventListeners();\n        \n        // Initialize Line2Helper module\n        this.initLine2Helper();\n    }\n\n    private _onLoaded() {\n        this.viewer.GetScene().add(this.interactionLayer);\n        this.dxfEntities = null;\n        this.clearHighlights();\n    }\n\n    private _onCleared() {\n         this.clearHighlights();\n         this.dxfEntities = null;\n         this.intersectableObjectsCache = null;\n    }\n\n    private async initLine2Helper() {\n        await getLine2Helper();\n    }\n\n    private updateResolution() {\n        const canvas = this.viewer.GetCanvas();\n        if (canvas) {\n            updateResolutionSync(canvas.width, canvas.height);\n        }\n    }\n\n    public setEnabled(enabled: boolean) {\n        this.isEnabled = enabled;\n        if (!enabled) {\n            this._clearHover();\n            this.clearHighlights();\n        }\n    }\n\n    private setupEventListeners() {\n        const canvas = this.viewer.GetCanvas();\n        if (!canvas) return;\n        \n        canvas.addEventListener('pointermove', this._boundOnPointerMove);\n        canvas.addEventListener('pointerleave', this._boundOnPointerLeave);\n        canvas.addEventListener('pointerdown', this._boundOnPointerDown);\n        canvas.addEventListener('pointerup', this._boundOnPointerUp);\n\n        this.viewer.Subscribe(\"pointerdown\", this._boundOnPointerDown);\n        this.viewer.Subscribe(\"resized\", this._boundOnViewChanged);\n        this.viewer.Subscribe(\"loaded\", this._boundOnLoaded);\n        this.viewer.Subscribe(\"cleared\", this._boundOnCleared);\n    }\n\n    public destroy() {\n        const canvas = this.viewer.GetCanvas();\n        if (canvas) {\n            canvas.removeEventListener('pointermove', this._boundOnPointerMove);\n            canvas.removeEventListener('pointerleave', this._boundOnPointerLeave);\n            canvas.removeEventListener('pointerdown', this._boundOnPointerDown);\n            canvas.removeEventListener('pointerup', this._boundOnPointerUp);\n        }\n\n        this.viewer.Unsubscribe(\"pointerdown\", this._boundOnPointerDown);\n        this.viewer.Unsubscribe(\"resized\", this._boundOnViewChanged);\n        this.viewer.Unsubscribe(\"loaded\", this._boundOnLoaded);\n        this.viewer.Unsubscribe(\"cleared\", this._boundOnCleared);\n\n        this._clearHover();\n        this.clearHighlights();\n        \n        clearLineMaterialCacheSync();\n        \n        if (this.animationFrameId !== null) {\n            cancelAnimationFrame(this.animationFrameId);\n            this.animationFrameId = null;\n        }\n\n        this.viewer.GetScene().remove(this.interactionLayer);\n    }\n\n    private resolveDxfObject(object: THREE.Object3D): THREE.Object3D | null {\n        let curr: THREE.Object3D | null = object;\n        while (curr) {\n            if (curr.userData && curr.userData.dxfHandle) {\n                return curr;\n            }\n            curr = curr.parent;\n        }\n        return null;\n    }\n\n    private ensureDxfIndex() {\n        if (this.dxfEntities) return;\n        const dxf = this.viewer.GetDxf();\n        if (!dxf) return;\n\n        this.dxfEntities = new Map();\n        \n        const indexEntities = (entities: any[]) => {\n            if (!entities) return;\n            for (const ent of entities) {\n                if (ent.handle) this.dxfEntities!.set(ent.handle, ent);\n            }\n        };\n\n        if (dxf.entities) indexEntities(dxf.entities);\n        \n        if (dxf.blocks) {\n            if (dxf.blocks instanceof Map) {\n                dxf.blocks.forEach((block: any) => {\n                   if (block.entities) indexEntities(block.entities);\n                });\n            } else {\n                for (const key in dxf.blocks) {\n                    const block = dxf.blocks[key];\n                    if (block.entities) indexEntities(block.entities);\n                }\n            }\n        }\n    }\n\n    private getGeometryFromHandle(handle: string): { vertices: any[], isClosed: boolean } | null {\n        this.ensureDxfIndex();\n        if (!this.dxfEntities) return null;\n        \n        const ent = this.dxfEntities.get(handle);\n        if (!ent) return null;\n\n        if (ent.type === 'LWPOLYLINE') {\n            const z = ent.elevation || 0;\n            const vertices = (ent.vertices || []).map((v: any) => ({ x: v.x ?? 0, y: v.y ?? 0, z: z }));\n            return { vertices, isClosed: !!(ent.shape || ent.closed) };\n        } else if (ent.type === 'POLYLINE') {\n             const vertices = (ent.vertices || []).map((v: any) => ({ x: v.x ?? 0, y: v.y ?? 0, z: v.z ?? 0 }));\n             return { vertices, isClosed: !!(ent.shape || ent.closed) };\n        } else if (ent.type === 'LINE') {\n            if (ent.vertices) {\n                const vertices = ent.vertices.map((v: any) => ({ x: v.x ?? 0, y: v.y ?? 0, z: v.z ?? 0 }));\n                return { vertices, isClosed: false };\n            }\n            if (ent.start && ent.end) {\n                return { \n                    vertices: [\n                        { x: ent.start.x ?? 0, y: ent.start.y ?? 0, z: ent.start.z ?? 0 }, \n                        { x: ent.end.x ?? 0, y: ent.end.y ?? 0, z: ent.end.z ?? 0 }\n                    ], \n                    isClosed: false \n                };\n            }\n        }\n        \n        return null;\n    }\n\n    private addOverlay(originalObj: THREE.Object3D, color: number, linewidth: number = 3, opacity: number = 1.0, isSimpleLine: boolean = false): boolean {\n        const target = this.resolveDxfObject(originalObj);\n        if (!target) return false;\n\n        if (this.activeOverlays.has(target)) return false;\n\n        target.updateMatrixWorld(true);\n\n        let overlay: THREE.Object3D | null = null;\n        const handle = target.userData.dxfHandle;\n\n        const geomData = !isSimpleLine ? this.getGeometryFromHandle(handle) : null;\n        \n        if (geomData) {\n            const material = getLineMaterialSync(color, linewidth, opacity);\n            overlay = createOverlayFromCoordinatesSync(\n                geomData.vertices, \n                material, \n                geomData.isClosed, \n                target.matrixWorld\n            );\n        } \n        \n        if (!overlay) {\n            if (target instanceof THREE.LineSegments || target instanceof THREE.Line) {\n                if (isSimpleLine) {\n                    const material = new THREE.LineBasicMaterial({\n                        color: color,\n                        linewidth: 1,\n                        depthTest: false,\n                        transparent: true,\n                        opacity: opacity\n                    });\n                    overlay = target.clone();\n                    (overlay as THREE.Line | THREE.LineSegments).material = material;\n                    overlay.renderOrder = 999;\n                } else {\n                    const material = getLineMaterialSync(color, linewidth, opacity);\n                    overlay = createOverlaySync(target as THREE.LineSegments, material);\n                }\n            } else if (target instanceof THREE.Mesh) {\n                const material = new THREE.MeshBasicMaterial({\n                    color: color,\n                    transparent: true,\n                    opacity: opacity,\n                    depthTest: false\n                });\n                overlay = target.clone();\n                (overlay as THREE.Mesh).material = material;\n                overlay.renderOrder = 999;\n            }\n        }\n\n        if (overlay) {\n            this.interactionLayer.add(overlay);\n            this.activeOverlays.set(target, overlay);\n            return true;\n        }\n        return false;\n    }\n\n    private removeOverlay(originalObj: THREE.Object3D) {\n        const target = this.resolveDxfObject(originalObj);\n        if (!target) return;\n\n        const overlay = this.activeOverlays.get(target);\n        if (overlay) {\n            this.cleanupOverlayResource(overlay);\n            this.activeOverlays.delete(target);\n            this.viewer.Render();\n        }\n    }\n\n    private clearAllOverlays() {\n        this.activeOverlays.forEach((overlay) => {\n            this.cleanupOverlayResource(overlay);\n        });\n        this.activeOverlays.clear();\n        this.viewer.Render();\n    }\n\n    private cleanupOverlayResource(overlay: THREE.Object3D) {\n        if (!overlay) return;\n\n        if (overlay.parent) {\n            overlay.parent.remove(overlay);\n        }\n\n        if ((overlay as any).geometry) {\n            (overlay as any).geometry.dispose();\n        }\n        \n        const material = (overlay as any).material;\n        if (material) {\n             const isLineSegments2 = (overlay as any).isLineSegments2 || overlay.type === 'LineSegments2';\n             const isLine2 = (overlay as any).isLine2 || overlay.type === 'Line2';\n             \n             if (!isLineSegments2 && !isLine2) {\n                if (Array.isArray(material)) {\n                    material.forEach(m => m.dispose());\n                } else {\n                    material.dispose();\n                }\n             }\n        }\n        \n        if (overlay.children) {\n            [...overlay.children].forEach(child => this.cleanupOverlayResource(child));\n        }\n    }\n\n    public setValidHandles(handles: string[] | null) {     \n        // If handles is null, undefined, or empty array â†’ nothing is interactive\n        // Only explicitly passed handles are interactive\n        this.validHandles = (handles && handles.length > 0) \n            ? new Set(handles.map(h => h.toLowerCase())) \n            : new Set(); \n        this.intersectableObjectsCache = null;\n        this.cacheLastUpdated = 0; \n    }\n\n    /**\n     * Check if a handle is in the valid/interactive handles list.\n     * Returns true if interaction is allowed, false if blocked.\n     * If validHandles is empty, NOTHING is interactive.\n     */\n    private isHandleInteractive(handle: string | undefined): boolean {\n        if (!handle) {\n            return false;\n        }\n        // validHandles is always a Set (never null) - empty Set means nothing is interactive\n        if (this.validHandles.size === 0) {\n            return false; // Nothing is interactive\n        }\n        const lowerHandle = handle.toLowerCase();\n        const isAllowed = this.validHandles.has(lowerHandle);\n        return isAllowed;\n    }\n\n    private getIntersectableObjects(): THREE.Object3D[] {\n        if (this.validHandles.size === 0) {\n            return [];\n        }\n\n        const now = Date.now();\n        if (this.intersectableObjectsCache && (now - this.cacheLastUpdated < this.CACHE_TTL)) {\n            return this.intersectableObjectsCache;\n        }\n\n        const objects: THREE.Object3D[] = [];\n        this.viewer.GetScene().traverse((obj: THREE.Object3D) => {\n            if (obj.userData.dxfHandle && obj.parent !== this.interactionLayer) {\n                if (!this.validHandles.has(obj.userData.dxfHandle.toLowerCase())) {\n                    return;\n                }\n                objects.push(obj);\n            }\n        });\n\n        this.intersectableObjectsCache = objects;\n        this.cacheLastUpdated = now;\n        return objects;\n    }\n\n    private _onPointerMove(event: PointerEvent) {\n        if (!this.isEnabled) return;\n\n        if (this.isMouseDown) {\n            this.isDragging = true;\n        }\n\n        const canvas = this.viewer.GetCanvas();\n        if (!canvas) {\n            this._clearHover();\n            return;\n        }\n\n        const mouse = getNDC(event.clientX, event.clientY, canvas);\n        const raycaster = new THREE.Raycaster();\n        raycaster.setFromCamera(mouse, this.viewer.GetCamera());\n        raycaster.params.Line.threshold = 6.0;\n\n        const intersects = raycaster.intersectObjects(this.getIntersectableObjects());\n\n        let hitObject: THREE.Object3D | null = null;\n        \n        // Find the first valid intersection (checking handle allowlist)\n        for (const intersection of intersects) {\n            const resolved = this.resolveDxfObject(intersection.object);\n            if (resolved) {\n                const handle = resolved.userData.dxfHandle;\n                // Double-check the handle is in the interactive list\n                if (this.isHandleInteractive(handle)) {\n                    hitObject = resolved;\n                    break;\n                }\n            }\n        }\n\n        if (hitObject) {\n            if (hitObject !== this.hoveredObject) {\n                this._clearHover();\n                this._startHover(hitObject);\n            }\n        } else {\n            if (this.hoveredObject) {\n                this._clearHover();\n            }\n        }\n    }\n\n    private _startHover(object: THREE.Object3D) {\n        this.hoveredObject = object;\n\n        const canvas = this.viewer.GetCanvas();\n        if (canvas) {\n            canvas.style.cursor = 'pointer';\n        }\n\n        this.addOverlay(object, 0x0099ff, 4, 0.5);\n        this.viewer.Render();  \n    }\n\n    private _clearHover() {\n        if (this.hoveredObject) {\n            const handle = this.hoveredObject.userData.dxfHandle;\n            if (!handle || !this.selectedHandles.has(handle.toLowerCase())) {\n                this.removeOverlay(this.hoveredObject);\n            }\n            this.hoveredObject = null;\n        }\n\n        const canvas = this.viewer.GetCanvas();\n        if (canvas) {\n            canvas.style.cursor = 'default';\n        }\n    }\n\n    private _onPointerDown(_event: PointerEvent) {\n        if (!this.isEnabled) return;\n        this.isMouseDown = true;\n        this.isDragging = false;\n    }\n\n    private _onPointerUp(event: PointerEvent) {\n        if (!this.isEnabled) return;\n\n        if(this.isDragging) {\n            this.isMouseDown = false;\n            this.isDragging = false;\n            return;\n        }\n\n        if (this.hoveredObject) {\n            const handle = this.hoveredObject.userData.dxfHandle;\n            // Double-check the handle is in the interactive list\n            if (this.isHandleInteractive(handle)) {\n                if (this.onClick) {\n                    this.onClick(handle);\n                }\n            }\n            this.isMouseDown = false;\n            this.isDragging = false;\n            return;\n        }\n\n        const canvas = this.viewer.GetCanvas();\n        if (!canvas) return;\n\n        const mouse = getNDC(event.clientX, event.clientY, canvas);\n        const raycaster = new THREE.Raycaster();\n        raycaster.setFromCamera(mouse, this.viewer.GetCamera());\n        raycaster.params.Line.threshold = 3.0;\n\n        const intersects = raycaster.intersectObjects(this.getIntersectableObjects());\n        for (const intersection of intersects) {\n            const hit = this.resolveDxfObject(intersection.object);\n            if (hit) {\n                const handle = hit.userData.dxfHandle;\n                // Verify handle is interactive before triggering click\n                if (this.isHandleInteractive(handle)) {\n                    if (this.onClick) {\n                        this.onClick(handle);\n                    } else {\n                        console.warn('[EntityInteraction] onClick callback is not defined!');\n                    }\n                    break;\n                }\n            }\n        }\n        \n        this.isMouseDown = false;\n        this.isDragging = false;\n    }\n\n    private _onPointerLeave() {\n        this._clearHover();\n        this.isMouseDown = false;\n        this.isDragging = false;\n    }\n\n    public highlightHandles(handles: string[]): void {\n        this.clearHighlights();\n        if (handles.length === 0) return;\n\n        const lowerHandles = handles.map(h => h.toLowerCase());\n        \n        this.viewer.GetScene().traverse((obj: THREE.Object3D) => {\n            const dxfHandle = obj.userData.dxfHandle;\n            if (dxfHandle && lowerHandles.includes(dxfHandle.toLowerCase()) && obj.parent !== this.interactionLayer) {\n                this.addOverlay(obj, 0x0099ff, 6);\n            }\n        });\n        this.viewer.Render();\n    }\n\n    public highlightContext(handles: string[]): void {\n        if (handles.length === 0) return;\n\n        const lowerHandles = handles.map(h => h.toLowerCase());\n        \n        this.viewer.GetScene().traverse((obj: THREE.Object3D) => {\n            const dxfHandle = obj.userData.dxfHandle;\n            if (dxfHandle && lowerHandles.includes(dxfHandle.toLowerCase()) && obj.parent !== this.interactionLayer) {\n                if (this.selectedHandles.has(dxfHandle.toLowerCase())) return;\n                this.addOverlay(obj, 0xcccccc, 2); \n            }\n        });\n\n        this.viewer.Render();\n    }\n\n    public selectHandles(handles: string[], contextHandles: string[] = [], shouldZoom: boolean = true): void {\n        this.clearHighlights();\n\n        if (handles.length === 0) return;\n\n        const lowerHandles = handles.map(h => h.toLowerCase());\n        handles.forEach(h => this.selectedHandles.add(h.toLowerCase()));\n\n        if (contextHandles.length > 0) {\n            this.highlightContext(contextHandles);\n        }\n\n        const matchedObjects: THREE.Object3D[] = [];\n\n        this.viewer.GetScene().traverse((obj: THREE.Object3D) => {\n            const dxfHandle = obj.userData.dxfHandle;\n            if (dxfHandle) {\n                if (lowerHandles.includes(dxfHandle.toLowerCase()) && obj.parent !== this.interactionLayer) {\n                    if (obj instanceof THREE.LineSegments || obj instanceof THREE.Line) {\n                        if (obj.geometry && !obj.geometry.boundingBox) {\n                            obj.geometry.computeBoundingBox();\n                        }\n                    }\n                    matchedObjects.push(obj);\n                }\n            }\n        });\n\n        if (matchedObjects.length === 0) return;\n\n        matchedObjects.forEach(obj => {\n            const dxfType = obj.userData.dxfType;\n            const isText = dxfType === 'TEXT' || dxfType === 'MTEXT' || dxfType === 'ATTRIB';\n\n            if (isText && obj instanceof THREE.LineSegments) { \n                 this.addOverlay(obj, 0x0099ff, 2, 1.0, true); \n            } else {\n                 this.addOverlay(obj, 0x0099ff, 5);\n            }\n        });\n        \n        this.viewer.Render();\n\n        const boundingBox = getSafeObjectsBounds(matchedObjects);\n\n        if (!boundingBox || boundingBox.isEmpty()) return;\n\n        if (contextHandles.length === 0) {\n             this.highlightContextInBounds(boundingBox, Array.from(this.selectedHandles));\n        }\n\n        this.createBoundingBoxOverlay(boundingBox);\n\n        if (shouldZoom) {\n            this.animateToFit(boundingBox, 800);\n        }\n    }\n\n    private highlightContextInBounds(boundingBox: THREE.Box3, selectedHandles: string[]): void {\n        const expandedBox = boundingBox.clone();\n        const size = new THREE.Vector3();\n        boundingBox.getSize(size);\n        expandedBox.expandByVector(size.multiplyScalar(0.1));\n\n        const lowerSelectedHandles = selectedHandles.map(h => h.toLowerCase());\n\n        this.viewer.GetScene().traverse((obj: THREE.Object3D) => {\n            if (obj.parent === this.interactionLayer) return;\n            \n            const dxfHandle = obj.userData.dxfHandle;\n            if (dxfHandle && lowerSelectedHandles.includes(dxfHandle.toLowerCase())) return;\n\n            if (!(obj instanceof THREE.Mesh || obj instanceof THREE.Line || obj instanceof THREE.LineSegments)) return;\n\n            const objectPosition = new THREE.Vector3();\n            obj.getWorldPosition(objectPosition);\n\n            if (expandedBox.containsPoint(objectPosition)) {\n                this.addOverlay(obj, 0xcccccc, 2);\n            }\n        });\n        \n        this.viewer.Render();\n    }\n\n    public clearHighlights(): void {\n        if (this.animationFrameId !== null) {\n            cancelAnimationFrame(this.animationFrameId);\n            this.animationFrameId = null;\n        }\n\n        this.selectedHandles.clear();\n        this.clearAllOverlays();\n        \n        if (this.boundingBoxMesh) {\n            this.cleanupOverlayResource(this.boundingBoxMesh);\n            this.boundingBoxMesh = null;\n        }\n\n        this.viewer.Render();\n    }\n\n    private createBoundingBoxOverlay(box: THREE.Box3): void {\n        if (box.isEmpty() || \n            !isFinite(box.min.x) || !isFinite(box.min.y) || !isFinite(box.min.z) ||\n            !isFinite(box.max.x) || !isFinite(box.max.y) || !isFinite(box.max.z)) {\n            return;\n        }\n\n        if (this.boundingBoxMesh) {\n            this.cleanupOverlayResource(this.boundingBoxMesh);\n            this.boundingBoxMesh = null;\n        }\n\n        const size = new THREE.Vector3();\n        const center = new THREE.Vector3();\n        box.getSize(size);\n        box.getCenter(center);\n        \n        const minSize = 10;\n        if (size.x < minSize) size.x = minSize;\n        if (size.y < minSize) size.y = minSize;\n        if (size.z < minSize) size.z = minSize;\n\n        try {\n            const geometry = new THREE.BoxGeometry(size.x, size.y, size.z);\n            const material = new THREE.MeshBasicMaterial({\n                color: 0x9333ea,\n                transparent: true,\n                opacity: 0.2,\n                side: THREE.DoubleSide,\n                depthTest: false\n            });\n\n            this.boundingBoxMesh = new THREE.Mesh(geometry, material);\n            this.boundingBoxMesh.position.copy(center);\n\n            const edges = new THREE.EdgesGeometry(geometry);\n            const lineMaterial = new THREE.LineBasicMaterial({ \n                color: 0x9333ea, \n                linewidth: 2,\n                depthTest: false \n            });\n            const wireframe = new THREE.LineSegments(edges, lineMaterial);\n            this.boundingBoxMesh.add(wireframe);\n\n            this.viewer.GetScene().add(this.boundingBoxMesh);\n            this.viewer.Render();\n        } catch (error) {\n            console.error('[EntityInteraction] Error creating bounding box overlay:', error);\n        }\n    }\n\n    private animateToFit(box: THREE.Box3, duration: number): void {\n        if (this.animationFrameId !== null) {\n            cancelAnimationFrame(this.animationFrameId);\n            this.animationFrameId = null;\n        }\n\n        const origin = this.viewer.GetOrigin();\n        if (box.isEmpty() || !isFinite(box.min.x) || !isFinite(box.min.y)) return;\n        \n        const size = new THREE.Vector3();\n        const center = new THREE.Vector3();\n        box.getSize(size);\n        box.getCenter(center);\n        \n        const targetCenterX = center.x - origin.x;\n        const targetCenterY = center.y - origin.y;\n        \n        const canvas = this.viewer.GetCanvas();\n        const canvasWidth = canvas ? canvas.width : 800;\n        const canvasHeight = canvas ? canvas.height : 600;\n        const aspect = canvasWidth / canvasHeight;\n        \n        const paddingFactor = 1.5;\n        let viewWidth = size.x * paddingFactor;\n        if (size.y * paddingFactor * aspect > viewWidth) {\n            viewWidth = size.y * paddingFactor * aspect;\n        }\n        \n        const minViewSize = 30;\n        viewWidth = Math.max(viewWidth, minViewSize);\n        \n        let startState: { cx: number, cy: number, vw: number } | null = null;\n        const startTime = performance.now();\n        \n        const animate = (currentTime: number) => {\n            if (!startState) {\n                const camera = this.viewer.GetCamera();\n                if (!isFinite(camera.position.x) || !isFinite(camera.zoom)) {\n                    this.animationFrameId = null;\n                    return;\n                }\n                startState = {\n                    cx: camera.position.x - origin.x,\n                    cy: camera.position.y - origin.y,\n                    vw: camera.right - camera.left\n                };\n\n                const dist = Math.hypot(targetCenterX - startState.cx, targetCenterY - startState.cy);\n                if (dist < startState.vw * 0.01 && Math.abs(viewWidth - startState.vw) < startState.vw * 0.01) {\n                    this.animationFrameId = null;\n                    return;\n                }\n            }\n            \n            const elapsed = currentTime - startTime;\n            const progress = Math.min(elapsed / duration, 1);\n            const eased = progress < 0.5 ? 4 * progress * progress * progress : 1 - Math.pow(-2 * progress + 2, 3) / 2;\n            \n            const curCX = startState.cx + (targetCenterX - startState.cx) * eased;\n            const curCY = startState.cy + (targetCenterY - startState.cy) * eased;\n            const curVW = startState.vw + (viewWidth - startState.vw) * eased;\n            this.viewer.SetView({ x: curCX + origin.x, y: curCY + origin.y }, curVW);\n            this.viewer.Render();\n            \n            if (progress < 1) {\n                this.animationFrameId = requestAnimationFrame(animate);\n            } else {\n                this.animationFrameId = null;\n            }\n        };\n        \n        this.animationFrameId = requestAnimationFrame(animate);\n    }\n}\n\n","import * as THREE from 'three';\nimport { getSafeObjectBounds, unprojectToPlane } from './threeUtils';\n\n// Type import only - runtime import is dynamic\ntype DxfViewer = import('@/core/dxf-viewer-library').DxfViewer;\n\nconst SNAP_THRESHOLD_PIXELS = 40;\nconst PREVIEW_LINE_DASH_SIZE = 10;\nconst PREVIEW_LINE_GAP_SIZE = 20;\nconst POINTS_SIZE_NORMAL = 7;\nconst POINTS_COLOR_NORMAL = 0xff0000;\nconst POINTS_COLOR_HOVER = 0xff5555;\nconst PREVIEW_LINE_COLOR_NORMAL = 0xff0000;\nconst MIN_SELECTION_POINTS = 3;\nconst RENDER_ORDER_UI = 999;\nconst POINT_MATERIAL_ATTENUATION = false;\n\n/**\n * Polygon Selection Tool\n * \n * Allows users to draw a polygon on the canvas and find all DXF entities\n * whose centers fall within that polygon. Returns the handles via callback.\n */\nexport class PolygonSelectionTool {\n  private viewer: DxfViewer;\n  private canvas: HTMLCanvasElement;\n  private isActive: boolean = false;\n  private points: THREE.Vector3[] = [];\n\n  private previewLine: THREE.Line | null = null;\n  private polygonLine: THREE.Line | null = null;\n  private pointsMesh: THREE.Points | null = null;\n  private startPointMesh: THREE.Points | null = null;\n  private mousePosition: THREE.Vector3 = new THREE.Vector3();\n\n  private completedPolygonLine: THREE.LineLoop | null = null;\n  private completedPointsMesh: THREE.Points | null = null;\n\n  private isHoveringNearStart: boolean = false;\n\n  private onComplete: (handles: string[]) => void;\n  private onCancel: () => void;\n\n  // Valid handles for filtering - only entities with these handles will be selected\n  // Empty set means nothing is selectable\n  private validHandles: Set<string> = new Set();\n\n  private _boundOnPointerDown: (e: PointerEvent) => void;\n  private _boundOnPointerMove: (e: PointerEvent) => void;\n  private _boundOnKeyDown: (e: KeyboardEvent) => void;\n  private _boundOnDblClick: (e: MouseEvent) => void;\n\n  constructor(viewer: DxfViewer, onComplete: (handles: string[]) => void, onCancel: () => void) {\n    this.viewer = viewer;\n    const canvas = viewer.GetCanvas();\n    if (!canvas) {\n      throw new Error('Canvas not available');\n    }\n    this.canvas = canvas;\n    this.onComplete = onComplete;\n    this.onCancel = onCancel;\n\n    this._boundOnPointerDown = this._onPointerDown.bind(this);\n    this._boundOnPointerMove = this._onPointerMove.bind(this);\n    this._boundOnKeyDown = this._onKeyDown.bind(this);\n    this._boundOnDblClick = this._onDblClick.bind(this);\n  }\n\n  /**\n   * Set the valid handles that can be selected by polygon selection.\n   * If null/undefined or empty array is passed, nothing will be selectable.\n   * @param handles Array of valid handle strings, or null/undefined\n   */\n  public setValidHandles(handles: string[] | null | undefined): void {\n    if (handles && handles.length > 0) {\n      this.validHandles = new Set(handles.map(h => h.toLowerCase()));\n    } else {\n      this.validHandles = new Set(); // Empty = nothing selectable\n    }\n  }\n\n  /**\n   * Check if a handle is in the valid handles list\n   */\n  private isHandleValid(handle: string): boolean {\n    // If no valid handles are set, nothing is valid\n    if (this.validHandles.size === 0) {\n      return false;\n    }\n    return this.validHandles.has(handle.toLowerCase());\n  }\n\n  public activate() {\n    if (this.isActive) return;\n\n    this.isActive = true;\n    this.points = [];\n\n    this.canvas.style.cursor = 'crosshair';\n\n    this.canvas.addEventListener('pointerdown', this._boundOnPointerDown, { capture: true });\n    this.canvas.addEventListener('pointermove', this._boundOnPointerMove);\n    window.addEventListener('keydown', this._boundOnKeyDown);\n    this.canvas.addEventListener('dblclick', this._boundOnDblClick, { capture: true });\n  }\n\n  public deactivate() {\n    if (!this.isActive) return;\n\n    this.isActive = false;\n\n    this.canvas.style.cursor = 'default';\n\n    this.canvas.removeEventListener('pointerdown', this._boundOnPointerDown, { capture: true });\n    this.canvas.removeEventListener('pointermove', this._boundOnPointerMove);\n    window.removeEventListener('keydown', this._boundOnKeyDown);\n    this.canvas.removeEventListener('dblclick', this._boundOnDblClick, { capture: true });\n\n    this.clearDrawingVisuals();\n  }\n\n  public clearCompletedPolygon() {\n    const scene = this.viewer.GetScene();\n    if (this.completedPolygonLine) {\n      scene.remove(this.completedPolygonLine);\n      this.completedPolygonLine.geometry.dispose();\n      (this.completedPolygonLine.material as THREE.Material).dispose();\n      this.completedPolygonLine = null;\n    }\n    if (this.completedPointsMesh) {\n      scene.remove(this.completedPointsMesh);\n      this.completedPointsMesh.geometry.dispose();\n      (this.completedPointsMesh.material as THREE.Material).dispose();\n      this.completedPointsMesh = null;\n    }\n    this.viewer.Render();\n  }\n\n  public clearInProgressPolygon() {\n    this.points = [];\n    this.clearDrawingVisuals();\n  }\n\n  private clearDrawingVisuals() {\n    this.clearDrawingVisualsOnly();\n    const scene = this.viewer.GetScene();\n    if (this.previewLine) {\n      scene.remove(this.previewLine);\n      this.previewLine.geometry.dispose();\n      (this.previewLine.material as THREE.Material).dispose();\n      this.previewLine = null;\n    }\n    this.viewer.Render();\n  }\n\n  private getSnapThreshold(): number {\n    const camera = this.viewer.GetCamera() as THREE.OrthographicCamera;\n\n    const worldWidth = (camera.right - camera.left) / camera.zoom;\n    const pixelToWorld = worldWidth / this.canvas.width;\n    return SNAP_THRESHOLD_PIXELS * pixelToWorld;\n  }\n\n  private isNearStartPoint(point: THREE.Vector3): boolean {\n    if (this.points.length < 3) {\n      return false;\n    }\n\n    const startPoint = this.points[0];\n    const distance = point.distanceTo(startPoint);\n    const threshold = this.getSnapThreshold();\n\n    return distance < threshold;\n  }\n\n  private _getWorldPosition(event: PointerEvent | MouseEvent): THREE.Vector3 {\n    return unprojectToPlane(event.clientX, event.clientY, this.canvas, this.viewer.GetCamera());\n  }\n\n  private _onPointerDown(event: PointerEvent) {\n    if (event.button !== 0) return;\n\n    event.stopPropagation();\n    event.preventDefault();\n\n    const point = this._getWorldPosition(event);\n    if (!point) return;\n\n    if (this.isNearStartPoint(point)) {\n      this.completeSelection();\n      return;\n    }\n\n    this.points.push(point);\n    this.updateVisuals();\n  }\n\n  private _onPointerMove(event: PointerEvent) {\n    const point = this._getWorldPosition(event);\n    if (!point) return;\n\n    this.mousePosition.copy(point);\n\n    this.isHoveringNearStart = this.isNearStartPoint(point);\n    this.canvas.style.cursor = this.isHoveringNearStart ? 'pointer' : 'crosshair';\n\n    this.updatePreview();\n    this.updateVisuals();\n  }\n\n  private _onDblClick(event: MouseEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.completeSelection();\n  }\n\n  private _onKeyDown(event: KeyboardEvent) {\n    if (!this.isActive) return;\n\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      event.stopPropagation();\n      this.completeSelection();\n    } else if (event.key === 'Escape') {\n      event.preventDefault();\n      event.stopPropagation();\n      this.cancelSelection();\n    }\n  }\n\n  private updateVisuals() {\n    const scene = this.viewer.GetScene();\n\n    this.clearDrawingVisualsOnly();\n\n    if (this.points.length > 0) {\n      this.drawRegularPoints(scene);\n      this.drawStartPoint(scene);\n      this.drawPolygonLine(scene);\n    }\n\n    this.viewer.Render();\n  }\n\n  private drawRegularPoints(scene: THREE.Scene) {\n    if (this.points.length <= 1) return;\n\n    const regularPointsGeometry = new THREE.BufferGeometry().setFromPoints(this.points.slice(1));\n    const regularPointsMaterial = new THREE.PointsMaterial({\n      color: POINTS_COLOR_NORMAL,\n      size: POINTS_SIZE_NORMAL,\n      sizeAttenuation: POINT_MATERIAL_ATTENUATION,\n    });\n    this.pointsMesh = new THREE.Points(regularPointsGeometry, regularPointsMaterial);\n    this.pointsMesh.renderOrder = RENDER_ORDER_UI;\n    scene.add(this.pointsMesh);\n  }\n\n  private drawStartPoint(scene: THREE.Scene) {\n    const startPointColor = this.isHoveringNearStart ? POINTS_COLOR_HOVER : POINTS_COLOR_NORMAL;\n    const startPointGeometry = new THREE.BufferGeometry().setFromPoints([this.points[0]]);\n    const startPointMaterial = new THREE.PointsMaterial({\n      color: startPointColor,\n      size: POINTS_SIZE_NORMAL,\n      sizeAttenuation: POINT_MATERIAL_ATTENUATION,\n    });\n    this.startPointMesh = new THREE.Points(startPointGeometry, startPointMaterial);\n    this.startPointMesh.renderOrder = RENDER_ORDER_UI;\n    scene.add(this.startPointMesh);\n  }\n\n  private drawPolygonLine(scene: THREE.Scene) {\n    if (this.points.length <= 1) return;\n\n    const lineGeometry = new THREE.BufferGeometry().setFromPoints(this.points);\n    const lineMaterial = new THREE.LineBasicMaterial({ color: POINTS_COLOR_NORMAL });\n    this.polygonLine = new THREE.Line(lineGeometry, lineMaterial);\n    this.polygonLine.renderOrder = RENDER_ORDER_UI;\n    scene.add(this.polygonLine);\n  }\n\n  private clearDrawingVisualsOnly() {\n    const scene = this.viewer.GetScene();\n    if (this.polygonLine) {\n      scene.remove(this.polygonLine);\n      this.polygonLine.geometry.dispose();\n      (this.polygonLine.material as THREE.Material).dispose();\n      this.polygonLine = null;\n    }\n    if (this.pointsMesh) {\n      scene.remove(this.pointsMesh);\n      this.pointsMesh.geometry.dispose();\n      (this.pointsMesh.material as THREE.Material).dispose();\n      this.pointsMesh = null;\n    }\n    if (this.startPointMesh) {\n      scene.remove(this.startPointMesh);\n      this.startPointMesh.geometry.dispose();\n      (this.startPointMesh.material as THREE.Material).dispose();\n      this.startPointMesh = null;\n    }\n  }\n\n  private updatePreview() {\n    if (this.points.length === 0) return;\n\n    const scene = this.viewer.GetScene();\n    this.clearPreviewLine(scene);\n\n    const lastPoint = this.points[this.points.length - 1];\n    const endPoint = this.calculatePreviewEndPoint();\n    const previewMaterial = this.createPreviewMaterial();\n\n    this.previewLine = new THREE.Line(\n      new THREE.BufferGeometry().setFromPoints([lastPoint, endPoint]),\n      previewMaterial\n    );\n\n    if (previewMaterial instanceof THREE.LineDashedMaterial) {\n      this.previewLine.computeLineDistances();\n    }\n    this.previewLine.renderOrder = RENDER_ORDER_UI;\n\n    scene.add(this.previewLine);\n    this.viewer.Render();\n  }\n\n  private clearPreviewLine(scene: THREE.Scene) {\n    if (this.previewLine) {\n      scene.remove(this.previewLine);\n      this.previewLine.geometry.dispose();\n      (this.previewLine.material as THREE.Material).dispose();\n      this.previewLine = null;\n    }\n  }\n\n  private calculatePreviewEndPoint(): THREE.Vector3 {\n    const isClosingPreview = this.isHoveringNearStart && this.points.length >= 3;\n    return isClosingPreview ? this.points[0] : this.mousePosition;\n  }\n\n  private createPreviewMaterial(): THREE.LineDashedMaterial {\n    return new THREE.LineDashedMaterial({\n      color: PREVIEW_LINE_COLOR_NORMAL,\n      dashSize: PREVIEW_LINE_DASH_SIZE,\n      gapSize: PREVIEW_LINE_GAP_SIZE,\n      transparent: false,\n    });\n  }\n\n  private completeSelection() {\n    if (this.points.length < MIN_SELECTION_POINTS) {\n      this.cancelSelection();\n      return;\n    }\n\n    this.createCompletedPolygonBoundary();\n\n    const selectedHandles = this.findEntitiesInPolygon();\n\n    this.onComplete(selectedHandles);\n    this.deactivate();\n  }\n\n  private createCompletedPolygonBoundary() {\n    const scene = this.viewer.GetScene();\n\n    if (this.completedPolygonLine) {\n      scene.remove(this.completedPolygonLine);\n    }\n    if (this.completedPointsMesh) {\n      scene.remove(this.completedPointsMesh);\n    }\n\n    const pointsGeometry = new THREE.BufferGeometry().setFromPoints(this.points);\n    const pointsMaterial = new THREE.PointsMaterial({\n      color: POINTS_COLOR_NORMAL,\n      size: POINTS_SIZE_NORMAL,\n      sizeAttenuation: POINT_MATERIAL_ATTENUATION\n    });\n    this.completedPointsMesh = new THREE.Points(pointsGeometry, pointsMaterial);\n    this.completedPointsMesh.renderOrder = RENDER_ORDER_UI;\n    this.completedPointsMesh.name = 'completed-polygon-points';\n    scene.add(this.completedPointsMesh);\n\n    const lineGeometry = new THREE.BufferGeometry().setFromPoints(this.points);\n    const lineMaterial = new THREE.LineBasicMaterial({\n      color: POINTS_COLOR_NORMAL\n    });\n\n    this.completedPolygonLine = new THREE.LineLoop(lineGeometry, lineMaterial);\n    this.completedPolygonLine.renderOrder = RENDER_ORDER_UI;\n    this.completedPolygonLine.name = 'completed-polygon-boundary';\n\n    scene.add(this.completedPolygonLine);\n    this.viewer.Render();\n  }\n\n  private cancelSelection() {\n    this.onCancel();\n    this.deactivate();\n  }\n\n  private findEntitiesInPolygon(): string[] {\n    const handles: string[] = [];\n\n    // If no valid handles are set, return empty (nothing is selectable)\n    if (this.validHandles.size === 0) {\n      return handles;\n    }\n\n    const polygonBox = new THREE.Box3().setFromPoints(this.points);\n\n    this.viewer.GetScene().traverse((obj: THREE.Object3D) => {\n      if (obj.userData.dxfHandle) {\n        const handle = obj.userData.dxfHandle as string;\n        \n        // Only consider entities that are in the valid handles list\n        if (!this.isHandleValid(handle)) {\n          return; // Skip this entity\n        }\n\n        const objBox = getSafeObjectBounds(obj);\n        if (objBox && polygonBox.intersectsBox(objBox)) {\n          const center = new THREE.Vector3();\n          objBox.getCenter(center);\n\n          if (this.isPointInPolygon(center)) {\n            handles.push(handle);\n          }\n        }\n      }\n    });\n\n    return handles;\n  }\n\n  private isPointInPolygon(point: THREE.Vector3): boolean {\n    let inside = false;\n    for (let i = 0, j = this.points.length - 1; i < this.points.length; j = i++) {\n      const xi = this.points[i].x, yi = this.points[i].y;\n      const xj = this.points[j].x, yj = this.points[j].y;\n\n      const intersect = ((yi > point.y) !== (yj > point.y))\n        && (point.x < (xj - xi) * (point.y - yi) / (yj - yi) + xi);\n      if (intersect) inside = !inside;\n    }\n    return inside;\n  }\n}\n\n","/**\n * @license lucide-react v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase();\nconst mergeClasses = (...classes) => classes.filter((className, index, array) => {\n  return Boolean(className) && className.trim() !== \"\" && array.indexOf(className) === index;\n}).join(\" \").trim();\n\nexport { mergeClasses, toKebabCase };\n//# sourceMappingURL=utils.js.map\n","/**\n * @license lucide-react v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\nimport { mergeClasses } from './shared/src/utils.js';\n\nconst Icon = forwardRef(\n  ({\n    color = \"currentColor\",\n    size = 24,\n    strokeWidth = 2,\n    absoluteStrokeWidth,\n    className = \"\",\n    children,\n    iconNode,\n    ...rest\n  }, ref) => {\n    return createElement(\n      \"svg\",\n      {\n        ref,\n        ...defaultAttributes,\n        width: size,\n        height: size,\n        stroke: color,\n        strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n        className: mergeClasses(\"lucide\", className),\n        ...rest\n      },\n      [\n        ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n        ...Array.isArray(children) ? children : [children]\n      ]\n    );\n  }\n);\n\nexport { Icon as default };\n//# sourceMappingURL=Icon.js.map\n","/**\n * @license lucide-react v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport { mergeClasses, toKebabCase } from './shared/src/utils.js';\nimport Icon from './Icon.js';\n\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ className, ...props }, ref) => createElement(Icon, {\n      ref,\n      iconNode,\n      className: mergeClasses(`lucide-${toKebabCase(iconName)}`, className),\n      ...props\n    })\n  );\n  Component.displayName = `${iconName}`;\n  return Component;\n};\n\nexport { createLucideIcon as default };\n//# sourceMappingURL=createLucideIcon.js.map\n","/**\n * @license lucide-react v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst RotateCcw = createLucideIcon(\"RotateCcw\", [\n  [\"path\", { d: \"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\", key: \"1357e3\" }],\n  [\"path\", { d: \"M3 3v5h5\", key: \"1xhq8a\" }]\n]);\n\nexport { RotateCcw as default };\n//# sourceMappingURL=rotate-ccw.js.map\n","/**\n * @license lucide-react v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst SquareDashedMousePointer = createLucideIcon(\"SquareDashedMousePointer\", [\n  [\n    \"path\",\n    {\n      d: \"M12.034 12.681a.498.498 0 0 1 .647-.647l9 3.5a.5.5 0 0 1-.033.943l-3.444 1.068a1 1 0 0 0-.66.66l-1.067 3.443a.5.5 0 0 1-.943.033z\",\n      key: \"xwnzip\"\n    }\n  ],\n  [\"path\", { d: \"M5 3a2 2 0 0 0-2 2\", key: \"y57alp\" }],\n  [\"path\", { d: \"M19 3a2 2 0 0 1 2 2\", key: \"18rm91\" }],\n  [\"path\", { d: \"M5 21a2 2 0 0 1-2-2\", key: \"sbafld\" }],\n  [\"path\", { d: \"M9 3h1\", key: \"1yesri\" }],\n  [\"path\", { d: \"M9 21h2\", key: \"1qve2z\" }],\n  [\"path\", { d: \"M14 3h1\", key: \"1ec4yj\" }],\n  [\"path\", { d: \"M3 9v1\", key: \"1r0deq\" }],\n  [\"path\", { d: \"M21 9v2\", key: \"p14lih\" }],\n  [\"path\", { d: \"M3 14v1\", key: \"vnatye\" }]\n]);\n\nexport { SquareDashedMousePointer as default };\n//# sourceMappingURL=square-dashed-mouse-pointer.js.map\n","/**\n * @license lucide-react v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ZoomIn = createLucideIcon(\"ZoomIn\", [\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }],\n  [\"line\", { x1: \"21\", x2: \"16.65\", y1: \"21\", y2: \"16.65\", key: \"13gj7c\" }],\n  [\"line\", { x1: \"11\", x2: \"11\", y1: \"8\", y2: \"14\", key: \"1vmskp\" }],\n  [\"line\", { x1: \"8\", x2: \"14\", y1: \"11\", y2: \"11\", key: \"durymu\" }]\n]);\n\nexport { ZoomIn as default };\n//# sourceMappingURL=zoom-in.js.map\n","/**\n * @license lucide-react v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ZoomOut = createLucideIcon(\"ZoomOut\", [\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }],\n  [\"line\", { x1: \"21\", x2: \"16.65\", y1: \"21\", y2: \"16.65\", key: \"13gj7c\" }],\n  [\"line\", { x1: \"8\", x2: \"14\", y1: \"11\", y2: \"11\", key: \"durymu\" }]\n]);\n\nexport { ZoomOut as default };\n//# sourceMappingURL=zoom-out.js.map\n","\"use client\";\n\nimport { useEffect, useRef, useCallback, useState, useMemo } from \"react\";\nimport * as THREE from \"three\";\nimport \"./dxfViewer.css\";\nimport { EntityInteraction } from \"@/utils/EntityInteraction\";\nimport { PolygonSelectionTool } from \"@/utils/PolygonSelectionTool\";\nimport { \n  ZoomIn, \n  ZoomOut, \n  RotateCcw, \n  SquareDashedMousePointer\n} from \"lucide-react\";\n\nfunction useLatest<T>(value: T): React.RefObject<T> {\n  const ref = useRef(value);\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n  return ref;\n}\n\n// =============================================================================\n// TYPES\n// =============================================================================\n\nexport interface SelectionChangeOptions {\n  isReset?: boolean;\n  isPolygonSelection?: boolean;\n}\n\nexport interface DxfViewerProps {\n  /** DXF file as ArrayBuffer */\n  file?: ArrayBuffer;\n  /** DXF file URL */\n  url?: string;\n  /** File name to display */\n  fileName?: string;\n  /** Font URLs for text rendering */\n  fonts?: string[];\n  /** Container className */\n  className?: string;\n\n  // ===== INPUTS (from parent - replaces store reads) =====\n  \n  /** \n   * Currently selected entity handles to highlight.\n   * When this changes, viewer will highlight and zoom to these entities.\n   * Example: User clicks a table row â†’ parent passes handle IDs here.\n   */\n  selectedHandles?: string[];\n  \n  /**\n   * Handles that are currently visible/filtered.\n   * Used to restrict which entities can be interacted with.\n   * If null, all entities are interactable.\n   */\n  visibleHandles?: string[] | null;\n  \n  /**\n   * Handles to highlight without zooming (e.g., filter results).\n   */\n  filteredHandles?: string[] | null;\n  \n  /**\n   * Handles that are interactive (can be hovered/clicked).\n   * If provided, only entities with handles in this list will respond to mouse events.\n   * If null/undefined, all entities are interactive (default behavior).\n   * This is separate from visibleHandles - entities can be visible but not interactive.\n   */\n  interactiveHandles?: string[] | null;\n  \n  /**\n   * Whether polygon selection mode should be active.\n   * Controlled externally by parent.\n   */\n  isPolygonMode?: boolean;\n\n  // ===== OUTPUTS (callbacks - replaces store writes) =====\n  \n  /** Called when viewer finishes loading */\n  onLoad?: () => void;\n  \n  /** Called on error */\n  onError?: (error: Error) => void;\n  \n  /** \n   * Called when selection changes (via click or polygon selection).\n   * The parent should use this to update its state/table.\n   * \n   * @param handles - Array of selected entity handle IDs\n   * @param options - Additional context about the selection\n   *   - isReset: true when user clicked \"reset\" button\n   *   - isPolygonSelection: true when selection was made via polygon tool\n   */\n  onSelectionChange?: (handles: string[], options?: SelectionChangeOptions) => void;\n  \n  /**\n   * Called when polygon mode is toggled internally (e.g., via toolbar button).\n   * Parent should update isPolygonMode prop accordingly.\n   */\n  onPolygonModeChange?: (active: boolean) => void;\n  \n  // ===== OPTIONS =====\n  \n  /** Enable/disable built-in toolbar (default: true) */\n  showToolbar?: boolean;\n  \n  /** Enable/disable polygon selection feature (default: true) */\n  enablePolygonSelection?: boolean;\n  \n  /** Enable/disable entity click interaction (default: true) */\n  enableInteraction?: boolean;\n  \n  /** Enable zoom animation when selecting entities (default: true) */\n  enableZoomOnSelect?: boolean;\n}\n\n// =============================================================================\n// TOOLBAR BUTTON COMPONENT\n// =============================================================================\n\ninterface ToolbarButtonProps {\n  onClick: () => void;\n  active?: boolean;\n  title: string;\n  children: React.ReactNode;\n}\n\nfunction ToolbarButton({ onClick, active, title, children }: ToolbarButtonProps) {\n  return (\n    <button\n      className={`dxf-toolbar-btn ${active ? 'dxf-toolbar-btn-active' : ''}`}\n      onClick={onClick}\n      title={title}\n      type=\"button\"\n    >\n      {children}\n    </button>\n  );\n}\n\n// =============================================================================\n// COMPONENT\n// =============================================================================\n\nexport function DxfViewer({\n  file,\n  url,\n  fileName: _fileName = \"drawing.dxf\",\n  fonts,\n  className,\n  // Inputs\n  selectedHandles = [],\n  visibleHandles = null,\n  filteredHandles = null,\n  interactiveHandles = null,\n  isPolygonMode: isPolygonModeProp = false,\n  // Outputs\n  onLoad,\n  onError,\n  onSelectionChange,\n  onPolygonModeChange,\n  // Options\n  showToolbar = true,\n  enablePolygonSelection = true,\n  enableInteraction = true,\n  enableZoomOnSelect = true,\n}: DxfViewerProps) {\n  \n  // Compute valid handles for interaction (memoized)\n  // interactiveHandles takes precedence over visibleHandles for restricting interactions\n  const validHandlesForInteraction = useMemo(\n    () => interactiveHandles ?? visibleHandles,\n    [interactiveHandles, visibleHandles]\n  );\n\n  // Store callbacks in refs to prevent effect re-runs\n  const onSelectionChangeRef = useLatest(onSelectionChange);\n  const onPolygonModeChangeRef = useLatest(onPolygonModeChange);\n  const onLoadRef = useLatest(onLoad);\n  const onErrorRef = useLatest(onError);\n\n  // Refs\n  const containerRef = useRef<HTMLDivElement>(null);\n  const viewerRef = useRef<any>(null);\n  const entityInteractionRef = useRef<EntityInteraction | null>(null);\n  const polygonToolRef = useRef<PolygonSelectionTool | null>(null);\n  const isPolygonSelectionRef = useRef<boolean>(false);\n  // Internal state\n  const [isPolygonModeInternal, setIsPolygonModeInternal] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [loadingPhase, setLoadingPhase] = useState<string>(\"Initializing...\");\n  const [error, setError] = useState<Error | null>(null);\n  const [DxfViewerClass, setDxfViewerClass] = useState<any>(null);\n\n  // Sync polygon mode from prop\n  useEffect(() => {\n    setIsPolygonModeInternal(isPolygonModeProp);\n  }, [isPolygonModeProp]);\n\n  // Dynamically import DxfViewer\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n\n    import(\"@/core/dxf-viewer-library\")\n      .then((module) => {\n        setDxfViewerClass(() => module.DxfViewer);\n      })\n      .catch((err) => {\n        console.error(\"Failed to load DxfViewer:\", err);\n        setError(err instanceof Error ? err : new Error(String(err)));\n        setIsLoading(false);\n      });\n  }, []);\n\n  // Initialize viewer when class is loaded\n  const initViewer = useCallback(() => {\n    if (!containerRef.current || !DxfViewerClass) return null;\n\n    // Destroy existing viewer\n    if (viewerRef.current) {\n      try {\n        viewerRef.current.Destroy();\n      } catch (e) {\n        console.warn(\"Error destroying viewer:\", e);\n      }\n      viewerRef.current = null;\n    }\n\n    try {\n      const options: any = {\n        autoResize: true,\n        clearColor: new THREE.Color(\"#ffffff\"),\n        clearAlpha: 1.0,\n        antialias: true,\n        colorCorrection: true,\n        blackWhiteInversion: true,\n      };\n\n      const viewer = new DxfViewerClass(containerRef.current, options);\n\n      if (!viewer.HasRenderer()) {\n        throw new Error(\"WebGL not available. Please check your browser supports WebGL.\");\n      }\n\n      viewerRef.current = viewer;\n      \n      // Subscribe to events (use refs to avoid stale closures)\n      viewer.Subscribe(\"loaded\", () => {\n        console.log(\"DXF loaded successfully\");\n        \n        // Fit to view\n        const bounds = viewer.GetBounds();\n        if (bounds) {\n          const origin = viewer.GetOrigin();\n          viewer.FitView(\n            bounds.minX - origin.x,\n            bounds.maxX - origin.x,\n            bounds.minY - origin.y,\n            bounds.maxY - origin.y,\n            0.1\n          );\n        }\n        \n        viewer.Render();\n        setIsLoading(false);\n        onLoadRef.current?.();\n      });\n\n      viewer.Subscribe(\"message\", (event: CustomEvent) => {\n        const { message, level } = event.detail;\n        if (level === \"error\") {\n          console.error(\"[DxfViewer]\", message);\n        } else if (level === \"warn\") {\n          console.warn(\"[DxfViewer]\", message);\n        }\n      });\n\n      return viewer;\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      setError(error);\n      setIsLoading(false);\n      onErrorRef.current?.(error);\n      return null;\n    }\n  }, [DxfViewerClass, onLoadRef, onErrorRef]);\n\n  // Load DXF file\n  const loadDxf = useCallback(\n    async (viewer: any, source: ArrayBuffer | string) => {\n      setIsLoading(true);\n      setError(null);\n      setLoadingPhase(\"Loading...\");\n\n      try {\n        let loadUrl: string;\n\n        if (typeof source === \"string\") {\n          loadUrl = source;\n        } else {\n          // Create blob URL from ArrayBuffer\n          const blob = new Blob([source], { type: \"application/octet-stream\" });\n          loadUrl = URL.createObjectURL(blob);\n        }\n\n        await viewer.Load({\n          url: loadUrl,\n          fonts: fonts ?? null,\n          progressCbk: (\n            phase: string,\n            processedSize: number,\n            totalSize: number | null\n          ) => {\n            let phaseText = phase;\n            if (phase === \"fetch\") phaseText = \"Downloading...\";\n            else if (phase === \"parse\") phaseText = \"Parsing DXF...\";\n            else if (phase === \"prepare\") phaseText = \"Preparing scene...\";\n            else if (phase === \"font\") phaseText = \"Loading fonts...\";\n            \n            if (totalSize && processedSize) {\n              const percent = Math.round((processedSize / totalSize) * 100);\n              setLoadingPhase(`${phaseText} ${percent}%`);\n            } else {\n              setLoadingPhase(phaseText);\n            }\n          },\n        });\n\n        // Clean up blob URL if created\n        if (typeof source !== \"string\") {\n          URL.revokeObjectURL(loadUrl);\n        }\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error(String(err));\n        console.error(\"Failed to load DXF:\", error);\n        setError(error);\n        setIsLoading(false);\n        onErrorRef.current?.(error);\n      }\n    },\n    [fonts, onErrorRef]\n  );\n\n  // Effect: Initialize and load when ready\n  // Note: callbacks use refs to prevent re-initialization when parent re-renders\n  useEffect(() => {\n    if (!DxfViewerClass || !containerRef.current) return;\n    \n    const viewer = initViewer();\n    if (!viewer) return;\n\n    // Init entity interaction (if enabled)\n    if (enableInteraction) {\n      entityInteractionRef.current = new EntityInteraction(viewer, (handle: string) => {\n         // Handle single click selection (use refs for latest callbacks)\n         setIsPolygonModeInternal(false);\n         onPolygonModeChangeRef.current?.(false);\n         isPolygonSelectionRef.current = false;\n         onSelectionChangeRef.current?.([handle]);\n      });\n      \n      // Set initial valid handles immediately after creation\n      if (validHandlesForInteraction) {\n        entityInteractionRef.current.setValidHandles(validHandlesForInteraction);\n      }\n    }\n    \n    // Init polygon tool (if enabled)\n    if (enablePolygonSelection) {\n      polygonToolRef.current = new PolygonSelectionTool(\n        viewer,\n        (handles: string[]) => {\n          setIsPolygonModeInternal(false);\n          onPolygonModeChangeRef.current?.(false);\n          isPolygonSelectionRef.current = true;\n          onSelectionChangeRef.current?.(handles, { isPolygonSelection: true });\n        },\n        () => {\n          setIsPolygonModeInternal(false);\n          onPolygonModeChangeRef.current?.(false);\n        }\n      );\n      \n      // Set initial valid handles immediately after creation\n      if (validHandlesForInteraction) {\n        polygonToolRef.current.setValidHandles(validHandlesForInteraction);\n      }\n    }\n\n    if (file) {\n      loadDxf(viewer, file);\n    } else if (url) {\n      loadDxf(viewer, url);\n    }\n\n    return () => {\n      entityInteractionRef.current?.destroy();\n      entityInteractionRef.current = null;\n      \n      polygonToolRef.current?.deactivate();\n      polygonToolRef.current = null;\n\n      if (viewerRef.current) {\n        try {\n          viewerRef.current.Destroy();\n        } catch (e) {\n          console.warn(\"Error destroying viewer:\", e);\n        }\n        viewerRef.current = null;\n      }\n    };\n  }, [DxfViewerClass, file, url, initViewer, loadDxf, enableInteraction, enablePolygonSelection, onSelectionChangeRef, onPolygonModeChangeRef]);\n\n  // Effect: Handle polygon mode changes\n  useEffect(() => {\n    if (!entityInteractionRef.current || !polygonToolRef.current) return;\n\n    if (isPolygonModeInternal) {\n      entityInteractionRef.current.setEnabled(false);\n      polygonToolRef.current.activate();\n    } else {\n      polygonToolRef.current.deactivate();\n      entityInteractionRef.current.setEnabled(true);\n      \n      // Re-apply selection highlighting if needed (only for direct selection, not polygon)\n      if (selectedHandles.length > 0 && !isPolygonSelectionRef.current) {\n        entityInteractionRef.current.selectHandles(selectedHandles, [], enableZoomOnSelect);\n      }\n    }\n  }, [isPolygonModeInternal, selectedHandles, enableZoomOnSelect]);\n\n  // Effect: Handle selectedHandles prop changes (Table â†’ Viewer sync)\n  useEffect(() => {\n    if (!entityInteractionRef.current || isLoading || error) return;\n    \n    // Check if this update came from polygon selection\n    const wasPolygonSelection = isPolygonSelectionRef.current;\n    // Reset the flag immediately so next updates work correctly\n    isPolygonSelectionRef.current = false;\n    \n    const contextHandles = visibleHandles || [];\n    \n    if (selectedHandles.length > 0) {\n      // Determine zoom behavior:\n      // - Single selection (length === 1): ALWAYS zoom - user explicitly clicked a row\n      // - Multi-selection from polygon: don't zoom, stay on polygon area\n      // - Multi-selection from other source: respect enableZoomOnSelect\n      const isSingleSelection = selectedHandles.length === 1;\n      const shouldZoom = enableZoomOnSelect && (isSingleSelection || !wasPolygonSelection);\n      entityInteractionRef.current.selectHandles(selectedHandles, contextHandles, shouldZoom);\n    } \n    else if (filteredHandles && filteredHandles.length > 0) {\n      entityInteractionRef.current.highlightHandles(filteredHandles);\n    }\n    else {\n      entityInteractionRef.current.selectHandles([], contextHandles, false);\n    }\n  }, [selectedHandles, visibleHandles, filteredHandles, isLoading, error, enableZoomOnSelect]);\n\n  // Effect: Update valid handles for interaction restriction\n  useEffect(() => {\n    if (entityInteractionRef.current) {\n      entityInteractionRef.current.setValidHandles(validHandlesForInteraction);\n    }\n    // Also update polygon tool's valid handles\n    if (polygonToolRef.current) {\n      polygonToolRef.current.setValidHandles(validHandlesForInteraction);\n    }\n  }, [validHandlesForInteraction, interactiveHandles]);\n\n  // Toolbar actions\n  const handleTogglePolygonMode = useCallback(() => {\n    const newMode = !isPolygonModeInternal;\n    setIsPolygonModeInternal(newMode);\n    onPolygonModeChangeRef.current?.(newMode);\n  }, [isPolygonModeInternal, onPolygonModeChangeRef]);\n\n  const handleFitToView = useCallback(() => {\n    const viewer = viewerRef.current;\n    if (!viewer) return;\n\n    const bounds = viewer.GetBounds();\n    if (bounds) {\n      const origin = viewer.GetOrigin();\n      viewer.FitView(\n        bounds.minX - origin.x,\n        bounds.maxX - origin.x,\n        bounds.minY - origin.y,\n        bounds.maxY - origin.y,\n        0.1\n      );\n      viewer.Render();\n    }\n  }, []);\n\n  const handleResetView = useCallback(() => {\n    // Exit polygon mode if active\n    setIsPolygonModeInternal(false);\n    onPolygonModeChangeRef.current?.(false);\n    \n    // Clear highlights\n    if (entityInteractionRef.current) {\n      entityInteractionRef.current.clearHighlights();\n    }\n    \n    // Clear the completed polygon boundary\n    if (polygonToolRef.current) {\n      polygonToolRef.current.clearCompletedPolygon();\n      polygonToolRef.current.clearInProgressPolygon();\n    }\n    \n    // Reset polygon selection flag\n    isPolygonSelectionRef.current = false;\n    \n    // Notify parent to reset selection\n    onSelectionChangeRef.current?.([], { isReset: true });\n    \n    // Reset view\n    handleFitToView();\n  }, [handleFitToView, onSelectionChangeRef, onPolygonModeChangeRef]);\n\n  const handleZoomIn = useCallback(() => {\n    const viewer = viewerRef.current;\n    if (!viewer) return;\n\n    const camera = viewer.GetCamera();\n    camera.zoom *= 1.25;\n    camera.updateProjectionMatrix();\n    viewer.Render();\n  }, []);\n\n  const handleZoomOut = useCallback(() => {\n    const viewer = viewerRef.current;\n    if (!viewer) return;\n\n    const camera = viewer.GetCamera();\n    camera.zoom *= 0.8;\n    camera.updateProjectionMatrix();\n    viewer.Render();\n  }, []);\n\n  return (\n    <div className={`dxf-viewer-wrapper ${className ?? \"\"}`}>\n      <div className=\"dxf-main-content\">\n        <div className=\"dxf-viewer-container\">\n          <div\n            ref={containerRef}\n            style={{ width: \"100%\", height: \"100%\", position: \"absolute\", inset: 0 }}\n          />\n\n          {isLoading && (\n            <div className=\"dxf-loading-overlay\">\n              <div className=\"dxf-loading-spinner\" />\n              <div className=\"dxf-loading-progress\">{loadingPhase}</div>\n            </div>\n          )}\n\n          {error && (\n            <div className=\"dxf-error-overlay\">\n              <svg className=\"dxf-error-icon\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                <circle cx=\"12\" cy=\"12\" r=\"10\" />\n                <path d=\"M15 9l-6 6M9 9l6 6\" />\n              </svg>\n              <div className=\"dxf-error-title\">Failed to load DXF</div>\n              <div className=\"dxf-error-message\">{error.message}</div>\n            </div>\n          )}\n\n          {showToolbar && !isLoading && !error && (\n            <div className=\"dxf-bottom-toolbar\">\n              <ToolbarButton onClick={handleResetView} title=\"Reset View\">\n                <RotateCcw size={18} />\n              </ToolbarButton>\n              \n              {enablePolygonSelection && (\n                <ToolbarButton\n                  active={isPolygonModeInternal}\n                  onClick={handleTogglePolygonMode}\n                  title=\"Polygon Selection Tool\"\n                >\n                  <SquareDashedMousePointer size={18} />\n                </ToolbarButton>\n              )}\n\n              <div className=\"dxf-toolbar-separator\" />\n\n              <ToolbarButton onClick={handleZoomOut} title=\"Zoom Out\">\n                <ZoomOut size={18} />\n              </ToolbarButton>\n\n              <ToolbarButton onClick={handleZoomIn} title=\"Zoom In\">\n                <ZoomIn size={18} />\n              </ToolbarButton>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default DxfViewer;\n\n"],"names":["REACT_ELEMENT_TYPE","REACT_FRAGMENT_TYPE","jsxProd","type","config","maybeKey","key","propName","reactJsxRuntime_production","getComponentNameFromType","REACT_CLIENT_REFERENCE","REACT_PROFILER_TYPE","REACT_STRICT_MODE_TYPE","REACT_SUSPENSE_TYPE","REACT_SUSPENSE_LIST_TYPE","REACT_ACTIVITY_TYPE","REACT_PORTAL_TYPE","REACT_CONTEXT_TYPE","REACT_CONSUMER_TYPE","REACT_FORWARD_REF_TYPE","innerType","REACT_MEMO_TYPE","REACT_LAZY_TYPE","testStringCoercion","value","checkKeyStringCoercion","JSCompiler_inline_result","JSCompiler_temp_const","JSCompiler_inline_result$jscomp$0","getTaskName","name","getOwner","dispatcher","ReactSharedInternals","UnknownOwner","hasValidKey","hasOwnProperty","getter","defineKeyPropWarningGetter","props","displayName","warnAboutAccessingKey","specialPropKeyWarningShown","elementRefGetterWithDeprecationWarning","componentName","didWarnAboutElementRef","ReactElement","owner","debugStack","debugTask","refProp","jsxDEVImpl","isStaticChildren","children","isArrayImpl","validateChildKeys","keys","k","didWarnAboutKeySpread","node","isValidElement","object","React","require$$0","createTask","callStackForError","unknownOwnerDebugStack","unknownOwnerDebugTask","reactJsxRuntime_development","trackActualOwner","jsxRuntimeModule","require$$1","getSafeObjectBounds","obj","isLine2","THREE","geometry","startAttr","endAttr","box","hasValidPoint","checkAttribute","attr","array","itemSize","i","x","y","z","point","positionAttribute","getSafeObjectsBounds","objects","combinedBox","hasValidBounds","getNDC","clientX","clientY","canvas","rect","unprojectToPlane","camera","ndc","vector","line2HelperModule","getLine2Helper","getLineMaterialSync","color","linewidth","opacity","createOverlayFromCoordinatesSync","vertices","material","isClosed","matrixWorld","createOverlaySync","line","updateResolutionSync","width","height","clearLineMaterialCacheSync","EntityInteraction","viewer","onClick","__publicField","enabled","curr","dxf","indexEntities","entities","ent","block","handle","v","originalObj","isSimpleLine","target","overlay","geomData","isLineSegments2","m","child","handles","h","lowerHandle","now","event","mouse","raycaster","intersects","hitObject","intersection","resolved","_event","hit","lowerHandles","dxfHandle","contextHandles","shouldZoom","matchedObjects","dxfType","boundingBox","selectedHandles","expandedBox","size","lowerSelectedHandles","objectPosition","center","minSize","edges","lineMaterial","wireframe","error","duration","origin","targetCenterX","targetCenterY","canvasWidth","canvasHeight","aspect","paddingFactor","viewWidth","startState","startTime","animate","currentTime","elapsed","progress","eased","curCX","curCY","curVW","SNAP_THRESHOLD_PIXELS","PREVIEW_LINE_DASH_SIZE","PREVIEW_LINE_GAP_SIZE","POINTS_SIZE_NORMAL","POINTS_COLOR_NORMAL","POINTS_COLOR_HOVER","PREVIEW_LINE_COLOR_NORMAL","MIN_SELECTION_POINTS","RENDER_ORDER_UI","POINT_MATERIAL_ATTENUATION","PolygonSelectionTool","onComplete","onCancel","scene","pixelToWorld","startPoint","distance","threshold","regularPointsGeometry","regularPointsMaterial","startPointColor","startPointGeometry","startPointMaterial","lineGeometry","lastPoint","endPoint","previewMaterial","pointsGeometry","pointsMaterial","polygonBox","objBox","inside","j","xi","yi","xj","yj","toKebabCase","string","mergeClasses","classes","className","index","defaultAttributes","Icon","forwardRef","strokeWidth","absoluteStrokeWidth","iconNode","rest","ref","createElement","tag","attrs","createLucideIcon","iconName","Component","RotateCcw","SquareDashedMousePointer","ZoomIn","ZoomOut","useLatest","useRef","useEffect","ToolbarButton","active","title","jsx","DxfViewer","file","url","_fileName","fonts","visibleHandles","filteredHandles","interactiveHandles","isPolygonModeProp","onLoad","onError","onSelectionChange","onPolygonModeChange","showToolbar","enablePolygonSelection","enableInteraction","enableZoomOnSelect","validHandlesForInteraction","useMemo","onSelectionChangeRef","onPolygonModeChangeRef","onLoadRef","onErrorRef","containerRef","viewerRef","entityInteractionRef","polygonToolRef","isPolygonSelectionRef","isPolygonModeInternal","setIsPolygonModeInternal","useState","isLoading","setIsLoading","loadingPhase","setLoadingPhase","setError","DxfViewerClass","setDxfViewerClass","module","err","initViewer","useCallback","e","options","bounds","_a","message","level","loadDxf","source","loadUrl","blob","phase","processedSize","totalSize","phaseText","percent","_b","wasPolygonSelection","isSingleSelection","handleTogglePolygonMode","newMode","handleFitToView","handleResetView","handleZoomIn","handleZoomOut","jsxs"],"mappings":"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","x_google_ignoreList":[0,1,2,6,7,8,9,10,11,12,13]}